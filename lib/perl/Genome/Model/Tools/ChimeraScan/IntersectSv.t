#!/usr/bin/env genome-perl

BEGIN { 
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More;
use Genome::Utility::Test;

my $class = "Genome::Model::Tools::ChimeraScan::IntersectSv";

use_ok($class);
my $data_dir   = Genome::Utility::Test->data_dir_ok($class, "v2");
my $bedpe_file = $data_dir.'/filtered.chimeras.bedpe';
my $sv_file    = $data_dir.'/svs.hq.annotated';

my $out_file = Genome::Sys->create_temp_file_path;
my $expected = $data_dir."/expected.out";

my $annotate_build_id = 124434505;

my $rt = $class->execute(
    annotation_build_id => $annotate_build_id,
    filtered_bedpe_file => $bedpe_file, 
    sv_output_file      => $sv_file,
    output_file         => $out_file
);
Genome::Utility::Test::compare_ok($out_file, $expected, "Output file was created as expected");

done_testing;
