#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More tests => 11;
use Genome::Test::Factory::Test qw(test_setup_object);

my $class = 'Genome::Test::Factory::Build';
use_ok($class);
use_ok("Genome::Test::Factory::Model::ReferenceAlignment");

my $m = Genome::Test::Factory::Model::ReferenceAlignment->setup_object();
ok($m->isa("Genome::Model"), "Generated a model");

my $b1 = test_setup_object($class, setup_object_args => [model_id => $m->id]);
my $b2 = test_setup_object($class, setup_object_args => [model_id => $m->id]);

isnt($b1->id, $b2->id, 'created distinct builds');
is($b2->status, 'New', q(status is 'New' when not passed in to args));

for my $status (qw(Failed Succeeded)) {
    my $b = test_setup_object($class,
        setup_object_args => [
            model_id => $m->id,
            status => $status,
        ]
    );
    is($b->status, $status, qq(status is '$status' when passed in to args));
}
