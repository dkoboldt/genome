#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above 'Genome';
use Test::More;

use Genome::Test::Factory::InstrumentData::Solexa;

my $class = 'Genome::Test::Factory::AnalysisProject';
use_ok($class);

my $ap = $class->setup_object();
isa_ok($ap, 'Genome::Config::AnalysisProject', 'It sets up an AnalysisProject object');

my $test_hash = {
    rules => { blah => 'test' },
    models => { 'Genome::Model::Test' => { auto_assign_inst_data => 1 } },
};
my $ap2 = $class->setup_object(config_hash => $test_hash);
isa_ok($ap2, 'Genome::Config::AnalysisProject', 'It sets up an AnalysisProject object');

my $inst_data = Genome::Test::Factory::InstrumentData::Solexa->setup_object();

my $config = $ap2->get_configuration_profile->get_config($inst_data);
ok($config, 'Its config is mocked up sufficiently to be usable');
done_testing();

