#!/usr/bin/env genome-perl

BEGIN { 
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More;
use Genome::Utility::Test qw (compare_ok);

my $class = "Genome::Db::Tgi::Command::ImportMitelman";

use_ok($class);
my $data_dir = Genome::Utility::Test->data_dir_ok($class, "v1");
my $url = $ENV{GENOME_TEST_URL}."/Genome-Db-Tgi-Command-ImportMitelman/v1/test.tar.gz";
my $output_dir = Genome::Sys->create_temp_directory;
my $cmd = $class->create(data_url => $url, output_dir => $output_dir);
ok($cmd->execute, "Import executed successfully");

for my $output_file (qw(MitelmanFivePrime.txt MitelmanThreePrime.txt)) {
    compare_ok("$output_dir/$output_file", "$data_dir/$output_file", "$output_file compares ok");
}

done_testing;
