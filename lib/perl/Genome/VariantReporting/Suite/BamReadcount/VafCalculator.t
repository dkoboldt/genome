#!/usr/bin/env genome-perl

BEGIN { 
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More;

my $pkg = 'Genome::VariantReporting::Suite::BamReadcount::VafCalculator';
use_ok($pkg);

my %test_data = (
    'long deletion 1' => {
        alt => 'GTATA',
        ref => 'GTGTGTGTGTATATATA',
        translation => '-TGTGTGTGTATA',
    },
    'long deletion 2' => {
        alt => 'GTATATA',
        ref => 'GTGTGTGTGTATATATA',
        translation => '-TGTGTGTGTA',
    },
    'long deletion 3' => {
        alt => 'GTA',
        ref => 'GTGTGTGTGTATATATA',
        translation => '-TGTGTGTGTATATA',
    },
    'long deletion 4' => {
        alt => 'G',
        ref => 'GTGTGTGTGTATATATA',
        translation => '-TGTGTGTGTATATATA',
    },
    'long deletion 5' => {
        alt => 'GTGTGTGTGTA',
        ref => 'GTGTGTGTGTATATATA',
        translation => '-TATATA',
    },
    'basic deletion 1' => {
        alt => 'TCG',
        ref => 'ATCG',
        translation => '-A',
    },
    'basic deletion 2' => {
        alt => 'ACG',
        ref => 'ATCG',
        translation => '-T',
    },
    'basic deletion 3' => {
        alt => 'ATG',
        ref => 'ATCG',
        translation => '-C',
    },
     'basic deletion 4' => {
        alt => 'ATC',
        ref => 'ATCG',
        translation => '-G',
    },
    'basic insertion' => {
        alt => 'AA',
        ref => 'A',
        translation => '+A',
    },
);

for my $test_name (sort keys %test_data) {
    my $data = $test_data{$test_name};
    is(Genome::VariantReporting::Suite::BamReadcount::VafCalculator::translated_allele($data->{alt}, $data->{ref}), $data->{translation}, "Translates ok: $test_name");
}

done_testing;
