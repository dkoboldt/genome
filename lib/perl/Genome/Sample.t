#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
};

use strict;
use warnings;

use above "Genome";

use Test::More;

use_ok('Genome::Sample') or die;

my $taxon = Genome::Taxon->__define__(name => '__TEST_TAXON__');
ok($taxon, 'define taxon');

my $source = Genome::Individual->__define__(name => '__TEST__IND__', taxon => $taxon);
ok($source, 'define source');

my $sample = Genome::Sample->create(
    name             => 'full_name.test',
    common_name      => 'common',
    extraction_label => 'TCGA-1234-232-12',
    extraction_type  => 'genomic dna',
    extraction_desc  => 'This is a test',
    source           => $source,
    tissue_desc      => 'normal',
    age => 99,
    body_mass_index => 22.4,
);
isa_ok($sample, 'Genome::Sample');
is($sample->name_in_vcf, "TCGA-1234-232-12");
is($sample->subject_type, 'sample_name', 'subject type is organism sample');
is_deeply($sample->taxon, $source->taxon, 'taxon');
is($sample->age, 99, 'age');
is($sample->body_mass_index, 22.4, 'body_mass_index');
ok(!$sample->is_rna, 'sample is not rna');
$sample->extraction_type('cdna');
ok($sample->is_rna, 'sample is now rna');

done_testing();
